<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Flappy Politics</title>

<style>
body {
    margin: 0;
    overflow: hidden;
    background: #70c5ce;
    touch-action: none;
    font-family: Arial, sans-serif;
}
canvas {
    display: block;
}
#score {
    position: absolute;
    top: 20px;
    width: 100%;
    text-align: center;
    font-size: 40px;
    color: white;
    font-weight: bold;
    text-shadow: 2px 2px 5px black;
}
#screen {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}
.box {
    background: rgba(0,0,0,0.6);
    color: white;
    padding: 25px 40px;
    border-radius: 15px;
    text-align: center;
}
button {
    padding: 12px 25px;
    font-size: 18px;
    border: none;
    background: orange;
    color: white;
    border-radius: 5px;
    cursor: pointer;
}
.hidden { display: none; }
</style>
</head>

<body>

<div id="score">0</div>

<div id="screen">
    <div id="startBox" class="box">
        <h2>Flappy Politics</h2>
        <p>Tap / Click / Space to Fly</p>
        <button onclick="startGame()">Start</button>
    </div>

    <div id="gameOverBox" class="box hidden">
        <h2>Game Over</h2>
        <p>Score: <span id="finalScore">0</span></p>
        <button onclick="startGame()">Restart</button>
    </div>
</div>

<canvas id="game"></canvas>

<script>
/* ---------- ASSETS ---------- */
const birdImg = new Image();
birdImg.src = "modi.png";      // bird image

const pipeImg = new Image();
pipeImg.src = "rahul.png";     // pipe image

const bgMusic = new Audio("song.mp3");
bgMusic.loop = true;

const hitSound = new Audio("hit.mp3");

/* ---------- CANVAS ---------- */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* ---------- GAME VARIABLES ---------- */
let gameRunning = false;
let score = 0;
let frames = 0;
let speed = 1.5;

const gravity = 0.18;

let bird = {
    x: 80,
    y: canvas.height / 2,
    w: 40,
    h: 40,
    vel: 0,
    jump: -3.6
};

let pipes = [];
let pipeGap = 170;
let pipeWidth = 70;
let pipeSpawnRate = 200;

/* ---------- INPUT ---------- */
function flap() {
    if (gameRunning) bird.vel = bird.jump;
}
document.addEventListener("click", flap);
document.addEventListener("touchstart", flap);
document.addEventListener("keydown", e => {
    if (e.code === "Space") flap();
});

/* ---------- GAME CONTROL ---------- */
function startGame() {
    score = 0;
    frames = 0;
    speed = 1.5;
    pipes = [];
    bird.y = canvas.height / 2;
    bird.vel = 0;
    gameRunning = true;

    document.getElementById("score").innerText = score;
    document.getElementById("startBox").classList.add("hidden");
    document.getElementById("gameOverBox").classList.add("hidden");

    bgMusic.currentTime = 0;
    bgMusic.play().catch(()=>{});

    loop();
}

function gameOver() {
    if (!gameRunning) return;
    gameRunning = false;
    bgMusic.pause();
    hitSound.play().catch(()=>{});

    document.getElementById("finalScore").innerText = score;
    document.getElementById("gameOverBox").classList.remove("hidden");
}

/* ---------- LOOP ---------- */
function loop() {
    update();
    draw();
    if (gameRunning) requestAnimationFrame(loop);
}

/* ---------- UPDATE ---------- */
function update() {
    frames++;

    bird.vel += gravity;
    bird.y += bird.vel;

    if (bird.y + bird.h > canvas.height || bird.y < 0) {
        gameOver();
    }

    if (frames % pipeSpawnRate === 0) {
        let top = Math.random() * (canvas.height - pipeGap - 120) + 60;
        pipes.push({ x: canvas.width, top });
    }

    for (let i = 0; i < pipes.length; i++) {
        let p = pipes[i];
        p.x -= speed;

        if (
            bird.x < p.x + pipeWidth &&
            bird.x + bird.w > p.x &&
            (bird.y < p.top || bird.y + bird.h > p.top + pipeGap)
        ) {
            gameOver();
        }

        if (p.x + pipeWidth < bird.x && !p.passed) {
            score++;
            p.passed = true;
            document.getElementById("score").innerText = score;
        }
    }

    pipes = pipes.filter(p => p.x + pipeWidth > 0);
}

/* ---------- DRAW ---------- */
function draw() {
    ctx.fillStyle = "#70c5ce";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    pipes.forEach(p => {
        ctx.drawImage(pipeImg, p.x, 0, pipeWidth, p.top);
        ctx.drawImage(pipeImg, p.x, p.top + pipeGap, pipeWidth, canvas.height);
    });

    ctx.drawImage(birdImg, bird.x, bird.y, bird.w, bird.h);
}
</script>
</body>
</html>
